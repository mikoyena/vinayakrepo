import redis                                          # Import the Redis module to use the the Redis SET command
import csv                                            # Import the CSV module to be able to read the csv file

list = []                                             # Declare an empty list to append the CSV data
length = 0
r = redis.Redis(host='127.0.0.1', port=6379, db=0)    # Redis Client Connectivity

with open('Bin_color_List.csv', 'r') as csv_file:     # Read the csv file contaiing the data
    csv_reader = csv.reader(csv_file)

    next(csv_reader)                                  # Skip the header line

    for line in csv_reader:                           # read each line from csv_reader and append it to the empty list
        list.append(line)

    for element in list:                              # read the data from the list and convert it to string to perform
        listToStr = ' '.join([str(eachelem) for eachelem in element])     # further operations
        length = len(listToStr)

        if "Black" in listToStr:                      # Write If loop for each bin color to separate the data and store
            val = listToStr[length-6:length]          # it in key value format
            key = listToStr[0:length-6]
            r.set(key, value=val)
        if "Blue" in listToStr:
            val = listToStr[length-5:length]
            key = listToStr[0:length-5]
            r.set(key, value=val)
        if "Brown" in listToStr:
            val = listToStr[length - 6:length]
            key = listToStr[0:length - 6]
            r.set(key, value=val)
        if "Green" in listToStr:
            val = listToStr[length - 6:length]
            key = listToStr[0:length - 6]
            r.set(key, value=val)
        if "No Bin" in listToStr:
            val = listToStr[length - 7:length]
            key = listToStr[0:length - 7]
            r.set(key, value=val)
        if "Red" in listToStr:
            val = listToStr[length - 4:length]
            key = listToStr[0:length - 4]
            r.set(key, value=val)
        if "Yellow" in listToStr:
            val = listToStr[length - 7:length]
            key = listToStr[0:length - 7]
            r.set(key, value=val)

# end of Code
